"use strict";function ownKeys(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function _objectSpread(a){for(var b,c=1;c<arguments.length;c++)b=null==arguments[c]?{}:arguments[c],c%2?ownKeys(Object(b),!0).forEach(function(c){_defineProperty(a,c,b[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):ownKeys(Object(b)).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))});return a}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}var Slid=/*#__PURE__*/function(){var b=Math.abs;function a(b){var c=this;if(_classCallCheck(this,a),this.opt=_objectSpread({el:".slid",offset:20,duration:220,perPage:1,itemTag:"div",restart:!1,loop:!1,onChange:null,onInit:null},b),this.item=0,this.change=!1,this.animating=!1,this.clonned=!1,this.opt.perPage=1,this.elt=document.querySelector(this.opt.el),this.elt.style.overflow="hidden",this.elt.style.display="inline-grid",this.elt.style.gridAutoColumns=100/this.opt.perPage+"%",this.elt.style.gridTemplateRows=100/this.opt.perPage+"%",this.elt.style.gridAutoFlow="column",this.containerWidth=this.elt.offsetWidth/this.opt.perPage,this.containerHeight=this.elt.offsetHeight,this.drag={start:0,end:0,prev:0,isPressed:!1},this.items=document.querySelectorAll(this.opt.el+">"+this.opt.itemTag),this.items_length=this.items.length-this.opt.perPage,console.log(this.items.length),this.opt.loop){if(2==this.items.length){this.clonned=!0;// Create 2 prev nodes ------------------------------------
var d=this.elt.children[1].cloneNode(!0);this.elt.prepend(d);var e=this.elt.children[1].cloneNode(!0);this.elt.prepend(e),this.items=document.querySelectorAll(this.opt.el+">"+this.opt.itemTag),this.items_length=this.items.length-this.opt.perPage,this.item=2}2<this.items.length&&this.slidePrev()}// init -------------------------------
this.stop=this.containerWidth*this.item,this.currentPos=this.stop,this.elt.scrollTo(this.stop,0),this.elt.addEventListener("touchstart",function(a){c.startAction(a,!0),c.drag.isPressed=!0}),this.elt.addEventListener("touchmove",function(a){a.stopPropagation(),a.preventDefault(),c.drag.end=a.touches[0].pageX,c.elt.scrollBy(c.drag.prev-c.drag.end,0),c.drag.prev=c.drag.end}),this.elt.addEventListener("touchend",function(a){c.swipeAction(a),c.drag.isPressed=!1}),this.elt.addEventListener("mousedown",function(a){c.startAction(a),c.drag.isPressed=!0}),this.elt.addEventListener("mousemove",function(a){a.stopPropagation(),a.preventDefault(),c.drag.isPressed&&(c.drag.end=a.pageX,c.elt.scrollBy(c.drag.prev-c.drag.end,0),c.drag.prev=c.drag.end)}),this.elt.addEventListener("mouseup",function(a){c.drag.isPressed=!1,c.swipeAction(a)}),this.elt.addEventListener("mouseout",function(){c.drag.isPressed=!1}),window.onresize=function(){c.containerWidth=c.elt.offsetWidth/c.opt.perPage,c.stop=c.containerWidth*c.item},requestAnimationFrame(function(){c.loop()}),"function"==typeof this.opt.onInit&&this.opt.onInit()}return _createClass(a,[{key:"startAction",value:function startAction(a,b){a.stopPropagation(),b?(this.drag.start=a.touches[0].pageX,this.drag.prev=a.touches[0].pageX):(this.drag.start=a.pageX,this.drag.prev=a.pageX)}},{key:"swipeAction",value:function swipeAction(a){a.stopPropagation();var c=b(this.drag.start-this.drag.end);if(c>this.opt.offset){0>this.drag.start-this.drag.end&&this.item--,0<this.drag.start-this.drag.end&&this.item++;var d=0,e=this.items_length;this.opt.restart&&(d=this.items_length,e=0),0>this.item&&(this.item=d),this.item>this.items_length&&(this.item=e)}this.currentPos=this.elt.scrollLeft,this.elt.scrollTo(this.containerWidth*this.item,0),this.stop=this.containerWidth*this.item}},{key:"setParm",value:function setParm(){var a=0,b=this.items_length;this.opt.restart&&!this.opt.loop&&(a=this.items_length,b=0),0>this.item&&(this.item=a),this.item>this.items_length&&(this.item=b),this.currentPos=this.elt.scrollLeft,this.elt.scrollTo(this.containerWidth*this.item,0),this.stop=this.containerWidth*this.item}},{key:"resetPos",value:function resetPos(){this.stop=this.containerWidth*this.item,this.currentPos=this.stop,this.elt.scrollTo(this.stop,0)}},{key:"next",value:function next(){this.item++,this.setParm()}},{key:"prev",value:function prev(){this.item--,this.setParm()}},{key:"slidePrev",value:function slidePrev(){0==this.item&&(this.elt.prepend(this.elt.children[this.items.length-1]),this.item++,this.resetPos())}},{key:"slideNext",value:function slideNext(){this.item==this.items_length&&(this.elt.appendChild(this.elt.children[0]),this.item--,this.resetPos())}},{key:"loop",value:function loop(){var a=this;if(!this.drag.isPressed){var c=this.opt.duration;60>c&&(c=60),this.currentPos+=(this.stop-this.currentPos)*(60/c),1>=b(this.currentPos-this.stop)?(this.elt.scrollTo(this.stop,0),!this.change&&this.animating&&(this.change=!0),this.animating=!1):(this.elt.scrollTo(this.currentPos,0),this.animating=!0)}this.change&&(this.opt.loop&&(this.slideNext(),this.slidePrev()),"function"==typeof this.opt.onChange&&this.opt.onChange(),this.change=!1),requestAnimationFrame(function(){a.loop()})}},{key:"onChange",value:function onChange(a){"function"==typeof a&&a()}}]),a}();